!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("json-refactor")):"function"==typeof define&&define.amd?define(["json-refactor"],n):e.seeFetch=n(e.JSONRefactor)}(this,function(e){e=e&&e.hasOwnProperty("default")?e.default:e;var n={optionsCollection:{},env:0};var t={errorField:"error",debug:!0},o=function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];console.info.apply(console,["see-fetch: "+e].concat(n))},r=function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];console.error.apply(console,["see-fetch: "+e].concat(n))};function i(e){var n;return e.status>=300?((n={})[t.errorField]=!0,n.response=e,n):e.json()}function s(t,o,r){var i=n.optionsCollection[r],s=n.optionsCollection.common||{},c=n.env,f=i.responseRefactor&&i.responseRefactor[c],a=s.responseRefactor&&s.responseRefactor[c],u=i.postHandle&&i.postHandle[c],l=s.postHandle&&s.postHandle[c],p=t;if(a&&e(p,a),f&&e(p,f),l){var d=l(p,o,r);d&&(p=d)}if(u){var h=u(p,o,r);h&&(p=h)}return p}function c(e,n){return function(o){return o[t.errorField]?o:s(o,n,e)}}function f(e,f){if(e){var a=n.optionsCollection[e],u=n.optionsCollection.common||{};if(a){var l=n.env,p=a.method&&a.method[l]||"get",d=a.stringify&&a.stringify[l]||!1,h=a.settings&&a.settings[l]||{},v=a.url&&a.url[l]||"",m=a.requestKeys&&a.requestKeys[l]||{},y=a.preHandle&&a.preHandle[l],g=u.preHandle&&u.preHandle[l],j=a.implement&&a.implement[l],O=Object.assign({},f||{});if(Object.keys(O).forEach(function(e){var n=m[e];n&&"string"==typeof n&&(O[n]=O[e],delete O[e])}),g){var b=g(O);b&&(O=b)}if(y){var E=y(O);E&&(O=E)}if(j)return new Promise(function(n){var r=function(r){t.debug&&(o("custom fetch implement for '"+e+"', and request params is:",O),o("result for '"+e+"' is:",r)),n(s(r,O,e))},i=j(function(e){r(e)},d?JSON.stringify(O):O);i&&i instanceof Promise&&i.then(function(e){r(e)})});if(h.method=p,"get"===p||"GET"===p){var C=v+(v.indexOf("?")<0?"?":"&")+function(e){if(!e)return"";var n=[];return Object.keys(e).forEach(function(t){n.push(t+"="+(void 0===e[t]?"":e[t]))}),n.join("&")}(O);return fetch(C,h).then(i).then(c(e,O))}return h.body=d?JSON.stringify(O):function(e){var n=new URLSearchParams;return e?(Object.keys(e).forEach(function(t){n.append(t,void 0===e[t]?"":e[t])}),n):n}(O),"get"!==p&&"GET"!==p&&"head"!==p&&"HEAD"!==p&&(h.headers||(h.headers={}),h.headers["Content-Type"]||(h.headers["Content-Type"]=d?"application/json":"application/x-www-form-urlencoded;charset=UTF-8")),fetch(v,h).then(i).then(c(e,O))}r("name '"+e+"' is not configured.")}}return f.config=function(e,t){"string"==typeof e?n.optionsCollection[e]=t:Object.keys(e).forEach(function(t){n.optionsCollection[t]=e[t]})},f.setEnv=function(e){n.env=e},f.getEnv=function(){return n.env},f.set=function(e){e&&Object.keys(e).forEach(function(n){t[n]=e[n]})},f});
//# sourceMappingURL=see-fetch.umd.js.map
